**XTUlearner战队RMUS技术报告**
学校：湘潭大学
项目名称：RMUS仿真器调试阶段技术报告
起止时间：2022.3.25-2022.3.26


# 一、 仿真器调试阶段技术方案

## 1、自动识别
ROS 上的检测功能包虽然能够实现目标检测功能，但检测准性和速度都还有待提高，特别是检测的准确性。如图1，我们识别过程中，多次采用检测功能包识别矿石5号，每次都会误识别成B，这将严重会影响ep机器人后续的夹取。在组委会的源程序中，只能识别1、2、3号矿石，4、5号均不能识别，可知4、5号没有被学习训练。如图2，面对兑换站，ep机器人将3是别成了1，将5识别成了o。所以，我们需要使用一个良好的算法训练五个矿石，提高准确性和检测速度。我们采用基于深度学习算法对相机传输的图像进行目标检测，当检测到目标时，使用深度相机对机器人和矿石的相对位置做出判断。
YOLOv5是一个结合了大量前人研究技术，加以组合并进行适当创新的算法，实现了速度和精度的完美平衡，有许多技巧可以提高卷积神经网络(CNN)的准确性。YOLOv5是一种单阶段目标检测算法，该算法在YOLOv4的基础上添加了一些新的改进思路，使其速度与精度都得到了极大的性能提升
 使用该算法训练的流程。收集组委会发布的数据集，通过OpenCV库增强数据，使用labelimag制作标签，生成.txt文件，在.yaml文件设置类别和分类数量，使用yolov5m.pt训练，最终生成训练模型detct.pt文件。在detect_cube.py创建该模型的接口，调用训练好的模型即可。


![[5-B.png]]图1
![[3-5.png]]图2
## 2、定位
Rtab-map用于基于外观的实时建图，是一个通过内存管理方法实现回环检测的开源库。从限制地图的大小以使得回环检测始终在固定的时间限制内处理，从而满足长期和大规模环境在线建图要求。通过使用深度相机、激光雷达传感器的数据，直接利用深度信息、相机内参及当前帧的位姿，计算底盘坐标对应在世界坐标系下的位置。

## 3、运动规划
我们采用的方法是基于move_base功能包自带的路径规划算法，通过调整关键参数，使可以机器人完成路径规划，前往指定位置。其中有几个参数尤其重要：
yaw_goal_tolerance
xy_goal_tolerance
robot_radius
inflation_radius
static_map
rolling_window
通过调整这些参数的值可以是运动规划的效果更好。
对于目标点的设定，我们是通过MovebaseAction实现目标点坐标的发布，进而实现机器人的自动导航。而由于任务中的重要位置坐标是固定的，所以目标坐标以列表的形式直接保存在程序中。

## 4、智能决策
暂未涉及相关方面。我们只是同过编写launch文件，根据经验确定每个每个程序运行所需要的时间，按顺序执行。

# 二、 Sim2real阶段拟采用的技术方案

## 1、自动识别
继续使用YOLOv5算法训练模型。Sim2real阶段我们将增加更多数据集，确保准确率，但会使用YOLOv5s.pt模型进行训练提高检测速度。
在仿真器调试阶段，最需要注重的是准确率，准确率占第一位，完成时间占第二位。使用YOLOv5m.pt训练准确率高，数据集少，所以上阶段选择YOLOv5m.pt。
但是到了Sim2real阶段，我们不仅要考虑机器人识别的准确率，而且要考虑提高机器人的识别速度。在本阶段，我们有时间准备更多的数据集，通过增大训练数量，能够明显提高目标检测的准确率，同时，训练模型我们改成YOLOv5s.pt。YOLOv5s虽然识别精度略低于YOLOv5m,但是其识别速度快，通过增加数据集，能够弥补丢失的准确率，甚至高于之前准确率。

## 2、定位
在实际定位过程中，可能会出现机器人坐标的漂移，我们认为这是由于传感器数据产生漂移导致的，所以解决方案分两个部分，对应两种传感器。
我们认为深度相机实际使用中可能出现的分辨率问题，以及测量不准出现离散的点云。前者我们暂时不知道使用什么方法可以较好的解决，但是后者可通过调整rtab-map中的参数来对点云图层进行一定的矫正。
激光雷达的精度在仿真器上的表现良好，可以使用激光雷达的数据作为参考去修正深度相机的数据。同时对实际情况中的传感器进行重新标定。

## 3、运动规划
我们认为运动规划中最有可能导致问题的因素是模拟器中所没有的惯性。所以里程计可能会出现较大问题，导致机器人的坐标和其实际上所在的坐标不匹配，进而使运动规划失效。所以在机器人的速度、加速度参数的设定上要针对实际比赛出现的情况进行调整。
另外还可能出现意外由于速度过快导致机器人撞墙，所以要根据时期情况修改提前停止的参数。

## 4、智能决策
由于我们使用的是定时，然后按顺序执行的方案。可能会产生由于上文的误差而导致某一程序执行所需的时间过长，进而导致整个控制逻辑出现问题。所以需要根据实际情况对上面几点完成修正后，再修改时间参数。
